<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>KF5003 WK10</title>
  <link rel="stylesheet" type="text/css" href="mystyle.css">
</head>
<body>
  <header>
    <h1>Week 10: AJAX</h1>
  </header>
  <main>
    <section id = "clickSection">
      <p>Click Here</p>
    </section>
    <section id="targetSection">
      <p>...</p>
    </section>
  </main>

  <script type="text/javascript">
      const requestURL = 'kittens.php';
      window.addEventListener('load',function () {
          'use strict';

          const clickSection = document.getElementById('clickSection');
          const targetSection = document.getElementById('targetSection');
          clickSection.addEventListener('load', setInterval(function () {
              getRequest(requestURL, updateTarget)
          }, 5000));
      });
      function getRequest( url, callback ) {
          'use strict';

          const httpRequest = new XMLHttpRequest();
          httpRequest.onreadystatechange = function() {
              let completed = 4, successful = 200;
              if (httpRequest.readyState == completed) {
                  if (httpRequest.status == successful) {
                      callback(httpRequest.responseText);
                  }
                  else {
                      alert('There was a problem with the request.');
                  }
              }
          };
          httpRequest.open('get', url, true);
          httpRequest.send(null);
      }
      function updateTarget( text ) {
          'use strict';
          targetSection.innerHTML = text;
      }
  </script>

</body>
</html>